<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>cveBuster API Documentation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            min-height: 100vh;
        }

        .sidebar {
            width: 280px;
            background-color: #2c3e50;
            color: white;
            padding: 30px 0;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
        }

        .sidebar-content {
            padding: 0 20px;
        }

        .sidebar h2 {
            font-size: 18px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #34495e;
        }

        .sidebar-nav {
            list-style: none;
        }

        .sidebar-nav li {
            margin-bottom: 10px;
        }

        .sidebar-nav a {
            color: #ecf0f1;
            text-decoration: none;
            display: block;
            padding: 8px 12px;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .sidebar-nav a:hover {
            background-color: #34495e;
            color: #3498db;
        }

        .sidebar-nav a.active {
            background-color: #3498db;
            color: white;
        }

        .main-content {
            margin-left: 280px;
            flex: 1;
            padding: 40px;
            background-color: white;
        }

        .header {
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 2px solid #ecf0f1;
        }

        .header h1 {
            font-size: 32px;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .header p {
            color: #7f8c8d;
            font-size: 16px;
        }

        .section {
            margin-bottom: 40px;
            display: none;
        }

        .section.active {
            display: block;
        }

        .section h2 {
            font-size: 24px;
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e0e0e0;
        }

        .section h3 {
            font-size: 18px;
            color: #34495e;
            margin-top: 25px;
            margin-bottom: 15px;
        }

        .endpoint {
            background-color: #f8f9fa;
            border-left: 4px solid #3498db;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 4px;
        }

        .endpoint-method {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 4px;
            font-weight: bold;
            margin-right: 10px;
            font-size: 12px;
        }

        .method-get {
            background-color: #d4edda;
            color: #155724;
        }

        .endpoint-path {
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
            color: #2c3e50;
            background-color: white;
            padding: 10px 15px;
            border-radius: 4px;
            margin-top: 10px;
            border: 1px solid #dee2e6;
        }

        .parameter-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            background-color: white;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            overflow: hidden;
        }

        .parameter-table th {
            background-color: #f8f9fa;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid #dee2e6;
            color: #2c3e50;
        }

        .parameter-table td {
            padding: 12px;
            border-bottom: 1px solid #dee2e6;
        }

        .parameter-table tr:last-child td {
            border-bottom: none;
        }

        .param-name {
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            color: #d63384;
            font-weight: 500;
        }

        .param-type {
            background-color: #e7f3ff;
            color: #0066cc;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 12px;
            font-family: monospace;
        }

        .param-required {
            background-color: #ffe7e7;
            color: #cc0000;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 11px;
            font-weight: bold;
        }

        .code-block {
            background-color: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 13px;
            line-height: 1.4;
        }

        .response-example {
            margin-top: 20px;
        }

        .success-response {
            border-left: 4px solid #28a745;
        }

        .error-response {
            border-left: 4px solid #dc3545;
        }

        .alert {
            padding: 15px;
            border-radius: 4px;
            margin: 20px 0;
            border-left: 4px solid;
        }

        .alert-info {
            background-color: #d1ecf1;
            border-color: #0c5460;
            color: #0c5460;
        }

        .alert-warning {
            background-color: #fff3cd;
            border-color: #856404;
            color: #856404;
        }

        .alert-success {
            background-color: #d4edda;
            border-color: #155724;
            color: #155724;
        }

        .status-code {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 12px;
            margin-right: 10px;
        }

        .status-200 {
            background-color: #d4edda;
            color: #155724;
        }

        .status-401 {
            background-color: #f8d7da;
            color: #721c24;
        }

        .status-500 {
            background-color: #f5c6cb;
            color: #721c24;
        }

        .example-section {
            margin: 20px 0;
        }

        .example-title {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
                border-bottom: 1px solid #ddd;
            }

            .main-content {
                margin-left: 0;
                padding: 20px;
            }

            .sidebar-nav {
                display: flex;
                flex-wrap: wrap;
            }

            .sidebar-nav li {
                margin-right: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="sidebar">
            <div class="sidebar-content">
                <h2>cveBuster API</h2>
                <ul class="sidebar-nav">
                    <li><a href="#overview" class="nav-link active" onclick="showSection('overview')">Overview</a></li>
                    <li><a href="#authentication" class="nav-link" onclick="showSection('authentication')">Authentication</a></li>
                    <li><a href="#endpoints" class="nav-link" onclick="showSection('endpoints')">Endpoints</a></li>
                    <li><a href="#pagination" class="nav-link" onclick="showSection('pagination')">Pagination</a></li>
                    <li><a href="#filtering" class="nav-link" onclick="showSection('filtering')">Filtering</a></li>
                    <li><a href="#examples" class="nav-link" onclick="showSection('examples')">Examples</a></li>
                    <li><a href="#errors" class="nav-link" onclick="showSection('errors')">Error Handling</a></li>
                </ul>
            </div>
        </div>

        <div class="main-content">
            <div class="header">
                <h1>cveBuster API Documentation</h1>
                <p>Complete reference for the cveBuster Vulnerability Scanning API</p>
            </div>

            <!-- Overview Section -->
            <div id="overview" class="section active">
                <h2>Overview</h2>
                <p>The cveBuster API provides programmatic access to vulnerability data with support for pagination and advanced filtering. This API allows you to retrieve vulnerability information in a structured format with flexible query parameters.</p>
                
                <h3>Base URL</h3>
                <div class="code-block">http://your-server/api</div>

                <h3>Key Features</h3>
                <ul style="margin-left: 20px; margin-top: 15px;">
                    <li><strong>Paginated Results:</strong> Retrieve large datasets efficiently with cursor-based pagination</li>
                    <li><strong>API Key Authentication:</strong> Secure access with API key-based authentication</li>
                    <li><strong>Time-based Filtering:</strong> Filter vulnerabilities by creation date range</li>
                    <li><strong>Flexible Parameters:</strong> Support for multiple parameter naming conventions</li>
                </ul>
            </div>

            <!-- Authentication Section -->
            <div id="authentication" class="section">
                <h2>Authentication</h2>
                <p>The cveBuster API uses API key authentication. You can authenticate requests in two ways:</p>

                <h3>Method 1: Basic Authentication</h3>
                <p>Include the API key in the Authorization header using Basic authentication:</p>
                <div class="code-block">Authorization: Basic YXBpa2V5OmN2ZWJ1c3Rlci1kZW1vLWtleS0xMjM0NQ==</div>
                <p style="margin-top: 10px; color: #7f8c8d; font-size: 14px;">The base64 encoding format is: <code>apikey:YOUR_API_KEY</code></p>

                <h3>Method 2: Direct API Key</h3>
                <p>Include the API key directly in the Authorization header:</p>
                <div class="code-block">Authorization: cvebuster-demo-key-12345</div>

                <div class="alert alert-info">
                    <strong>Default API Key:</strong> <code>cvebuster-demo-key-12345</code>
                </div>

                <div class="alert alert-warning">
                    <strong>Security Note:</strong> Always use HTTPS in production environments. The API key is sensitive information and should be protected like a password.
                </div>
            </div>

            <!-- Endpoints Section -->
            <div id="endpoints" class="section">
                <h2>Endpoints</h2>

                <div class="endpoint">
                    <div>
                        <span class="endpoint-method method-get">GET</span>
                        <strong>Get Vulnerabilities</strong>
                    </div>
                    <div class="endpoint-path">/vulnerabilities</div>
                    
                    <h3 style="margin-top: 20px; margin-bottom: 10px;">Description</h3>
                    <p>Retrieve a paginated list of vulnerabilities with optional filtering by time range.</p>

                    <h3>Query Parameters</h3>
                    <table class="parameter-table">
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Required</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span class="param-name">page_size</span></td>
                                <td><span class="param-type">integer</span></td>
                                <td><span class="param-required">No</span></td>
                                <td>Number of records per page. Default: <code>50</code>. Max: <code>1000</code></td>
                            </tr>
                            <tr>
                                <td><span class="param-name">next_token</span> / <span class="param-name">nextToken</span></td>
                                <td><span class="param-type">string</span></td>
                                <td><span class="param-required">No</span></td>
                                <td>Pagination cursor for retrieving the next page of results</td>
                            </tr>
                            <tr>
                                <td><span class="param-name">createdAt__gt</span></td>
                                <td><span class="param-type">string (ISO 8601)</span></td>
                                <td><span class="param-required">No</span></td>
                                <td>Return vulnerabilities modified after this timestamp (greater than)</td>
                            </tr>
                            <tr>
                                <td><span class="param-name">createdAt__lt</span></td>
                                <td><span class="param-type">string (ISO 8601)</span></td>
                                <td><span class="param-required">No</span></td>
                                <td>Return vulnerabilities modified before this timestamp (less than)</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>Response</h3>
                    <table class="parameter-table">
                        <thead>
                            <tr>
                                <th>Field</th>
                                <th>Type</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span class="param-name">vulnerabilities</span></td>
                                <td><span class="param-type">array</span></td>
                                <td>Array of vulnerability objects for this page</td>
                            </tr>
                            <tr>
                                <td><span class="param-name">next_token</span></td>
                                <td><span class="param-type">string | null</span></td>
                                <td>Pagination token for the next page, or null if this is the last page</td>
                            </tr>
                            <tr>
                                <td><span class="param-name">total_filtered</span></td>
                                <td><span class="param-type">integer</span></td>
                                <td>Total number of vulnerabilities matching the filter criteria</td>
                            </tr>
                            <tr>
                                <td><span class="param-name">page_size</span></td>
                                <td><span class="param-type">integer</span></td>
                                <td>Number of results returned in this page</td>
                            </tr>
                            <tr>
                                <td><span class="param-name">offset</span></td>
                                <td><span class="param-type">integer</span></td>
                                <td>Starting position of this page in the complete result set</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>Status Codes</h3>
                    <div style="margin: 15px 0;">
                        <div style="margin-bottom: 10px;">
                            <span class="status-code status-200">200 OK</span>
                            Vulnerabilities retrieved successfully
                        </div>
                        <div style="margin-bottom: 10px;">
                            <span class="status-code status-401">401 Unauthorized</span>
                            Invalid or missing API key
                        </div>
                        <div>
                            <span class="status-code status-500">500 Internal Server Error</span>
                            Data file not found or server error
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pagination Section -->
            <div id="pagination" class="section">
                <h2>Pagination</h2>
                <p>The API uses cursor-based pagination to handle large result sets efficiently.</p>

                <h3>How Pagination Works</h3>
                <ol style="margin-left: 20px; margin-top: 15px;">
                    <li>Make an initial request without a <code>next_token</code></li>
                    <li>If <code>next_token</code> is present in the response, there are more results available</li>
                    <li>Include the <code>next_token</code> in your next request to retrieve the following page</li>
                    <li>Repeat until <code>next_token</code> is null (last page)</li>
                </ol>

                <h3>Pagination Parameters</h3>
                <ul style="margin-left: 20px; margin-top: 15px;">
                    <li><strong>page_size:</strong> Controls how many results are returned per request (default: 50)</li>
                    <li><strong>next_token / nextToken:</strong> Cursor for fetching the next page (both names are supported)</li>
                </ul>

                <div class="alert alert-info">
                    <strong>Note:</strong> The API supports both camelCase (<code>nextToken</code>) and snake_case (<code>next_token</code>) parameter names for flexibility.
                </div>
            </div>

            <!-- Filtering Section -->
            <div id="filtering" class="section">
                <h2>Filtering</h2>
                <p>Filter vulnerabilities by time range using ISO 8601 datetime parameters.</p>

                <h3>Time Range Filtering</h3>
                <p>Use the following parameters to filter by modification date:</p>
                <ul style="margin-left: 20px; margin-top: 15px;">
                    <li><strong>createdAt__gt:</strong> Greater than (return results after this time)</li>
                    <li><strong>createdAt__lt:</strong> Less than (return results before this time)</li>
                </ul>

                <h3>ISO 8601 Format</h3>
                <p>Datetime values should be in ISO 8601 format. Both formats are supported:</p>
                <div class="code-block">2024-01-15T10:30:00Z
2024-01-15T10:30:00+00:00</div>

                <h3>Example</h3>
                <p>Get vulnerabilities modified between January 1 and January 31, 2024:</p>
                <div class="code-block">/api/vulnerabilities?createdAt__gt=2024-01-01T00:00:00Z&createdAt__lt=2024-01-31T23:59:59Z</div>

                <div class="alert alert-info">
                    <strong>Tip:</strong> Combine time filtering with pagination for efficient data retrieval of large datasets.
                </div>
            </div>

            <!-- Examples Section -->
            <div id="examples" class="section">
                <h2>Examples</h2>

                <h3>Example 1: Basic Request</h3>
                <p>Retrieve the first 50 vulnerabilities:</p>
                <div class="example-section">
                    <div class="example-title">Request</div>
                    <div class="code-block">curl -H "Authorization: cvebuster-demo-key-12345" \
  http://localhost/api/vulnerabilities</div>
                </div>

                <h3>Example 2: Custom Page Size</h3>
                <p>Retrieve 100 vulnerabilities per page:</p>
                <div class="example-section">
                    <div class="example-title">Request</div>
                    <div class="code-block">curl -H "Authorization: cvebuster-demo-key-12345" \
  "http://localhost/api/vulnerabilities?page_size=100"</div>
                </div>

                <h3>Example 3: Pagination</h3>
                <p>Fetch the next page using a pagination token:</p>
                <div class="example-section">
                    <div class="example-title">Request</div>
                    <div class="code-block">curl -H "Authorization: cvebuster-demo-key-12345" \
  "http://localhost/api/vulnerabilities?next_token=MTAw"</div>
                </div>

                <h3>Example 4: Time Range Filtering</h3>
                <p>Get vulnerabilities modified in the last 7 days:</p>
                <div class="example-section">
                    <div class="example-title">Request</div>
                    <div class="code-block">curl -H "Authorization: cvebuster-demo-key-12345" \
  "http://localhost/api/vulnerabilities?createdAt__gt=2024-01-01T00:00:00Z&createdAt__lt=2024-01-08T00:00:00Z"</div>
                </div>

                <h3>Example 5: Basic Authentication</h3>
                <p>Using Basic Auth with the API key:</p>
                <div class="example-section">
                    <div class="example-title">Request</div>
                    <div class="code-block">curl -H "Authorization: Basic YXBpa2V5OmN2ZWJ1c3Rlci1kZW1vLWtleS0xMjM0NQ==" \
  http://localhost/api/vulnerabilities</div>
                </div>

                <h3>Example 6: Complete Example with Python</h3>
                <div class="example-section">
                    <div class="example-title">Python Script</div>
                    <div class="code-block">import requests
import json

API_KEY = "cvebuster-demo-key-12345"
BASE_URL = "http://localhost/api"

# Set up headers
headers = {
    "Authorization": API_KEY
}

# Fetch first page
params = {
    "page_size": 50,
    "createdAt__gt": "2024-01-01T00:00:00Z"
}

response = requests.get(
    f"{BASE_URL}/vulnerabilities",
    headers=headers,
    params=params
)

data = response.json()
print(f"Total filtered: {data['total_filtered']}")
print(f"Results: {len(data['vulnerabilities'])}")

# If there are more results, fetch next page
while data.get('next_token'):
    params['next_token'] = data['next_token']
    response = requests.get(
        f"{BASE_URL}/vulnerabilities",
        headers=headers,
        params=params
    )
    data = response.json()
    print(f"Fetched {len(data['vulnerabilities'])} more results")</div>
                </div>
            </div>

            <!-- Error Handling Section -->
            <div id="errors" class="section">
                <h2>Error Handling</h2>

                <h3>HTTP Status Codes</h3>
                <table class="parameter-table">
                    <thead>
                        <tr>
                            <th>Status Code</th>
                            <th>Description</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span class="status-code status-200">200</span></td>
                            <td>OK - Request successful</td>
                            <td>Process the returned data</td>
                        </tr>
                        <tr>
                            <td><span class="status-code status-401">401</span></td>
                            <td>Unauthorized - Invalid API key</td>
                            <td>Verify your API key is correct</td>
                        </tr>
                        <tr>
                            <td><span class="status-code status-500">500</span></td>
                            <td>Internal Server Error</td>
                            <td>Check server status and retry</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Error Response Format</h3>
                <div class="code-block">{
  "error": "Unauthorized"
}</div>

                <h3>Common Issues and Solutions</h3>
                <ul style="margin-left: 20px; margin-top: 15px;">
                    <li><strong>401 Unauthorized:</strong> Double-check your API key in the Authorization header</li>
                    <li><strong>Invalid next_token:</strong> Tokens may expire or become invalid; make a new request without a token</li>
                    <li><strong>Malformed datetime:</strong> Ensure datetime values are in ISO 8601 format with timezone info</li>
                    <li><strong>500 Server Error:</strong> The data file may be missing; contact system administrator</li>
                </ul>

                <div class="alert alert-warning">
                    <strong>Debugging Tip:</strong> Check the server logs to understand why a request failed. The API logs all incoming requests with their parameters.
                </div>
            </div>
        </div>
    </div>

    <script>
        function showSection(sectionId) {
            // Hide all sections
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => {
                section.classList.remove('active');
            });

            // Remove active class from all nav links
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => {
                link.classList.remove('active');
            });

            // Show the selected section
            const activeSection = document.getElementById(sectionId);
            if (activeSection) {
                activeSection.classList.add('active');
            }

            // Add active class to the clicked nav link
            event.target.classList.add('active');

            // Update URL hash
            window.location.hash = sectionId;
        }

        // Handle page load with hash
        window.addEventListener('load', () => {
            const hash = window.location.hash.substring(1);
            if (hash) {
                showSection(hash);
            }
        });

        // Handle hash changes
        window.addEventListener('hashchange', () => {
            const hash = window.location.hash.substring(1);
            if (hash) {
                showSection(hash);
            }
        });
    </script>
</body>
</html>
