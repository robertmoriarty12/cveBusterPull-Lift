#!/bin/bash
# Simple bash script to run the API documentation server on Linux

# Get the directory where this script is located
SCRIPT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"

# Change to the script directory
cd "$SCRIPT_DIR"

# Configuration
PORT=${PORT:-80}

echo "=================================================="
echo "cveBuster API Documentation Server"
echo "=================================================="
echo ""

# Check if port is < 1024 and warn about sudo
if [ "$PORT" -lt 1024 ]; then
    if [ "$EUID" -ne 0 ]; then
        echo "Warning: Port $PORT requires root privileges"
        echo "Run with: sudo PORT=$PORT bash server.sh"
        echo ""
        exit 1
    fi
fi

echo "Starting server on port $PORT..."
echo "Serving from: $SCRIPT_DIR"
echo ""
echo "Access the documentation at:"
echo "  http://localhost:$PORT"
echo ""
echo "Press Ctrl+C to stop the server"
echo ""
echo "=================================================="
echo ""

# Start Python HTTP server
cd "$SCRIPT_DIR"
python3 -m http.server $PORT --directory "$SCRIPT_DIR"
