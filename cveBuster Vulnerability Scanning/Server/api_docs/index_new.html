<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>cveBuster API Documentation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: white;
            min-height: 100vh;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 50px 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 36px;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 16px;
            opacity: 0.9;
        }

        .base-url {
            background-color: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 4px;
            margin-top: 20px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 14px;
            border-left: 3px solid #3498db;
        }

        .nav-tabs {
            display: flex;
            flex-wrap: wrap;
            background-color: #ecf0f1;
            border-bottom: 2px solid #bdc3c7;
            padding: 0;
            margin: 0;
            list-style: none;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-tabs li {
            margin: 0;
        }

        .nav-tabs a {
            display: block;
            padding: 15px 20px;
            text-decoration: none;
            color: #2c3e50;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            font-weight: 500;
            cursor: pointer;
        }

        .nav-tabs a:hover {
            background-color: #d5dbdb;
            border-bottom-color: #3498db;
        }

        .nav-tabs a.active {
            background-color: white;
            color: #3498db;
            border-bottom-color: #3498db;
        }

        .content {
            padding: 40px;
        }

        section {
            margin-bottom: 50px;
            scroll-margin-top: 120px;
        }

        h2 {
            font-size: 28px;
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #ecf0f1;
        }

        h3 {
            font-size: 18px;
            color: #34495e;
            margin-top: 25px;
            margin-bottom: 15px;
        }

        .endpoint {
            background-color: #f8f9fa;
            border-left: 4px solid #3498db;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .endpoint-method {
            display: inline-block;
            padding: 6px 14px;
            border-radius: 4px;
            font-weight: bold;
            margin-right: 10px;
            font-size: 12px;
        }

        .method-get {
            background-color: #d4edda;
            color: #155724;
        }

        .endpoint-path {
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
            color: #2c3e50;
            background-color: white;
            padding: 12px 15px;
            border-radius: 4px;
            margin-top: 10px;
            border: 1px solid #dee2e6;
            word-break: break-all;
        }

        .parameter-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            background-color: white;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            overflow: hidden;
        }

        .parameter-table th {
            background-color: #f8f9fa;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid #dee2e6;
            color: #2c3e50;
        }

        .parameter-table td {
            padding: 12px;
            border-bottom: 1px solid #dee2e6;
        }

        .parameter-table tr:last-child td {
            border-bottom: none;
        }

        .param-name {
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            color: #d63384;
            font-weight: 500;
        }

        .param-type {
            background-color: #e7f3ff;
            color: #0066cc;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 12px;
            font-family: monospace;
        }

        .param-required {
            background-color: #ffe7e7;
            color: #cc0000;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 11px;
            font-weight: bold;
        }

        .param-optional {
            background-color: #e7ffe7;
            color: #006600;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 11px;
            font-weight: bold;
        }

        .code-block {
            background-color: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 13px;
            line-height: 1.4;
        }

        .alert {
            padding: 15px;
            border-radius: 4px;
            margin: 20px 0;
            border-left: 4px solid;
        }

        .alert-info {
            background-color: #d1ecf1;
            border-color: #0c5460;
            color: #0c5460;
        }

        .alert-warning {
            background-color: #fff3cd;
            border-color: #856404;
            color: #856404;
        }

        .status-code {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 12px;
            margin-right: 10px;
        }

        .status-200 {
            background-color: #d4edda;
            color: #155724;
        }

        .status-401 {
            background-color: #f8d7da;
            color: #721c24;
        }

        .status-500 {
            background-color: #f5c6cb;
            color: #721c24;
        }

        .field-callout {
            background-color: #f0f8ff;
            border-left: 4px solid #2196F3;
            padding: 12px;
            margin: 10px 0;
            border-radius: 3px;
        }

        .field-callout strong {
            color: #2196F3;
        }

        ul {
            margin-left: 20px;
            margin-top: 10px;
        }

        li {
            margin-bottom: 8px;
        }

        @media (max-width: 768px) {
            .content {
                padding: 20px;
            }

            h2 {
                font-size: 22px;
            }

            .nav-tabs {
                flex-direction: column;
            }

            .nav-tabs a {
                border-bottom: none;
                border-left: 3px solid transparent;
                padding-left: 10px;
            }

            .nav-tabs a.active {
                border-bottom: none;
                border-left-color: #3498db;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>cveBuster API Documentation</h1>
            <p>Complete reference for the cveBuster Vulnerability Scanning API</p>
            <div class="base-url">
                Base URL: http://cvebuster.eastus.cloudapp.azure.com:5000/api
            </div>
        </div>

        <ul class="nav-tabs">
            <li><a href="#overview" onclick="scrollToSection(event, 'overview')" class="nav-link active">Overview</a></li>
            <li><a href="#authentication" onclick="scrollToSection(event, 'authentication')" class="nav-link">Authentication</a></li>
            <li><a href="#endpoints" onclick="scrollToSection(event, 'endpoints')" class="nav-link">Endpoints</a></li>
            <li><a href="#pagination" onclick="scrollToSection(event, 'pagination')" class="nav-link">Pagination</a></li>
            <li><a href="#filtering" onclick="scrollToSection(event, 'filtering')" class="nav-link">Filtering</a></li>
            <li><a href="#examples" onclick="scrollToSection(event, 'examples')" class="nav-link">Examples</a></li>
            <li><a href="#errors" onclick="scrollToSection(event, 'errors')" class="nav-link">Error Handling</a></li>
        </ul>

        <div class="content">
            <!-- Overview Section -->
            <section id="overview">
                <h2>Overview</h2>
                <p>The cveBuster API provides programmatic access to vulnerability data with support for pagination, time-based filtering, and advanced querying. This API is designed for integration with security operations platforms and vulnerability management systems.</p>
                
                <h3>Key Features</h3>
                <ul>
                    <li><strong>Paginated Results:</strong> Retrieve large datasets efficiently with cursor-based pagination</li>
                    <li><strong>API Key Authentication:</strong> Secure access with API key-based authentication</li>
                    <li><strong>Time-based Filtering:</strong> Filter vulnerabilities by creation date range using ISO 8601 format</li>
                    <li><strong>Flexible Parameters:</strong> Support for multiple parameter naming conventions</li>
                    <li><strong>Structured Data:</strong> Comprehensive vulnerability information including severity, CVSS scores, and remediation guidance</li>
                </ul>

                <h3>Supported Data Fields</h3>
                <p>The API returns vulnerability records with the following key fields:</p>
                <ul>
                    <li><strong>id / cveId:</strong> Unique CVE identifier (e.g., CVE-2024-0001)</li>
                    <li><strong>title:</strong> Vulnerability title/name</li>
                    <li><strong>description:</strong> Detailed vulnerability description</li>
                    <li><strong>severity:</strong> Risk level (CRITICAL, HIGH, MEDIUM, LOW)</li>
                    <li><strong>cvssScore:</strong> CVSS v3.1 base score (0-10)</li>
                    <li><strong>LastModified:</strong> Last update timestamp (ISO 8601)</li>
                    <li><strong>affected_packages:</strong> List of affected software packages</li>
                    <li><strong>remediation:</strong> Recommended fix or mitigation strategy</li>
                </ul>

                <div class="alert alert-info">
                    <strong>Integration Tip:</strong> These fields align with standard security connector data models and can be easily mapped to security information and event management (SIEM) systems.
                </div>
            </section>

            <!-- Authentication Section -->
            <section id="authentication">
                <h2>Authentication</h2>
                <p>All API requests require authentication using an API key. The API supports two authentication methods:</p>

                <h3>Method 1: Direct API Key (Recommended)</h3>
                <p>Include the API key directly in the Authorization header:</p>
                <div class="code-block">Authorization: cvebuster-demo-key-12345</div>

                <h3>Method 2: Basic Authentication</h3>
                <p>Include the API key in the Authorization header using Basic authentication:</p>
                <div class="code-block">Authorization: Basic YXBpa2V5OmN2ZWJ1c3Rlci1kZW1vLWtleS0xMjM0NQ==</div>
                <p style="margin-top: 10px; color: #7f8c8d; font-size: 14px;">The base64 encoding format is: <code>apikey:YOUR_API_KEY</code></p>

                <h3>Default API Key</h3>
                <div class="code-block">cvebuster-demo-key-12345</div>

                <div class="alert alert-warning">
                    <strong>Security Note:</strong> Always use HTTPS in production environments. Treat API keys as sensitive credentials similar to passwords. Rotate keys regularly and never commit them to version control.
                </div>
            </section>

            <!-- Endpoints Section -->
            <section id="endpoints">
                <h2>Endpoints</h2>

                <div class="endpoint">
                    <div>
                        <span class="endpoint-method method-get">GET</span>
                        <strong>Get Vulnerabilities</strong>
                    </div>
                    <div class="endpoint-path">GET /api/vulnerabilities</div>
                    
                    <h3 style="margin-top: 20px; margin-bottom: 10px;">Description</h3>
                    <p>Retrieve a paginated list of vulnerabilities with optional filtering by time range. This endpoint returns structured vulnerability data suitable for import into security platforms.</p>

                    <h3>Query Parameters</h3>
                    <table class="parameter-table">
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Required</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span class="param-name">page_size</span></td>
                                <td><span class="param-type">integer</span></td>
                                <td><span class="param-optional">No</span></td>
                                <td>Number of records per page. Default: <code>50</code>. Max: <code>1000</code></td>
                            </tr>
                            <tr>
                                <td><span class="param-name">next_token</span> / <span class="param-name">nextToken</span></td>
                                <td><span class="param-type">string</span></td>
                                <td><span class="param-optional">No</span></td>
                                <td>Pagination cursor (base64 encoded offset) for retrieving the next page of results</td>
                            </tr>
                            <tr>
                                <td><span class="param-name">createdAt__gt</span></td>
                                <td><span class="param-type">string (ISO 8601)</span></td>
                                <td><span class="param-optional">No</span></td>
                                <td>Return vulnerabilities modified after this timestamp (greater than)</td>
                            </tr>
                            <tr>
                                <td><span class="param-name">createdAt__lt</span></td>
                                <td><span class="param-type">string (ISO 8601)</span></td>
                                <td><span class="param-optional">No</span></td>
                                <td>Return vulnerabilities modified before this timestamp (less than)</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>Response Schema</h3>
                    <table class="parameter-table">
                        <thead>
                            <tr>
                                <th>Field</th>
                                <th>Type</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span class="param-name">vulnerabilities</span></td>
                                <td><span class="param-type">array</span></td>
                                <td>Array of vulnerability objects for this page</td>
                            </tr>
                            <tr>
                                <td><span class="param-name">next_token</span></td>
                                <td><span class="param-type">string | null</span></td>
                                <td>Pagination token for the next page, or null if this is the last page</td>
                            </tr>
                            <tr>
                                <td><span class="param-name">total_filtered</span></td>
                                <td><span class="param-type">integer</span></td>
                                <td>Total number of vulnerabilities matching the filter criteria</td>
                            </tr>
                            <tr>
                                <td><span class="param-name">page_size</span></td>
                                <td><span class="param-type">integer</span></td>
                                <td>Number of results returned in this page</td>
                            </tr>
                            <tr>
                                <td><span class="param-name">offset</span></td>
                                <td><span class="param-type">integer</span></td>
                                <td>Starting position of this page in the complete result set</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>Response Status Codes</h3>
                    <div style="margin: 15px 0;">
                        <div style="margin-bottom: 10px;">
                            <span class="status-code status-200">200 OK</span>
                            Vulnerabilities retrieved successfully
                        </div>
                        <div style="margin-bottom: 10px;">
                            <span class="status-code status-401">401 Unauthorized</span>
                            Invalid or missing API key
                        </div>
                        <div>
                            <span class="status-code status-500">500 Internal Server Error</span>
                            Data file not found or server error
                        </div>
                    </div>

                    <h3>Sample Vulnerability Object</h3>
                    <div class="code-block">{
  "id": "CVE-2024-0001",
  "cveId": "CVE-2024-0001",
  "title": "Sample Vulnerability 1",
  "description": "This is a sample vulnerability for testing",
  "severity": "HIGH",
  "cvssScore": 7.5,
  "LastModified": "2024-01-01T10:00:00Z",
  "affected_packages": ["package1", "package2"],
  "remediation": "Update to version 2.0 or higher"
}</div>

                    <h3>Vulnerability Object Schema</h3>
                    <table class="parameter-table">
                        <thead>
                            <tr>
                                <th>Field</th>
                                <th>Type</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span class="param-name">VulnId</span></td>
                                <td><span class="param-type">string</span></td>
                                <td>Unique CVE identifier (e.g., CVE-2024-10046)</td>
                            </tr>
                            <tr>
                                <td><span class="param-name">VulnTitle</span></td>
                                <td><span class="param-type">string</span></td>
                                <td>Vulnerability title/name</td>
                            </tr>
                            <tr>
                                <td><span class="param-name">Severity</span></td>
                                <td><span class="param-type">string</span></td>
                                <td>Risk level: Critical, High, Medium, Low</td>
                            </tr>
                            <tr>
                                <td><span class="param-name">CVSS</span></td>
                                <td><span class="param-type">number</span></td>
                                <td>CVSS v3.1 base score (0-10). Higher scores indicate greater severity</td>
                            </tr>
                            <tr>
                                <td><span class="param-name">MachineName</span></td>
                                <td><span class="param-type">string</span></td>
                                <td>Name/identifier of the affected asset or host</td>
                            </tr>
                            <tr>
                                <td><span class="param-name">AssetCriticality</span></td>
                                <td><span class="param-type">string</span></td>
                                <td>Business criticality of the asset: Critical, High, Medium, Low</td>
                            </tr>
                            <tr>
                                <td><span class="param-name">DiscoveryDate</span></td>
                                <td><span class="param-type">string (ISO 8601)</span></td>
                                <td>When the vulnerability was first discovered</td>
                            </tr>
                            <tr>
                                <td><span class="param-name">LastModified</span></td>
                                <td><span class="param-type">string (ISO 8601)</span></td>
                                <td>Last update timestamp - use for incremental sync</td>
                            </tr>
                            <tr>
                                <td><span class="param-name">Status</span></td>
                                <td><span class="param-type">string</span></td>
                                <td>Current remediation status: Open, In Progress, Resolved</td>
                            </tr>
                            <tr>
                                <td><span class="param-name">PatchAvailable</span></td>
                                <td><span class="param-type">boolean</span></td>
                                <td>Whether a patch or update is available for remediation</td>
                            </tr>
                            <tr>
                                <td><span class="param-name">ExploitAvailable</span></td>
                                <td><span class="param-type">boolean</span></td>
                                <td>Whether public exploit code is available for this vulnerability</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>Sample Response</h3>
                    <div class="code-block">{
  "next_token": "MTAw",
  "offset": 50,
  "page_size": 50,
  "total_filtered": 505,
  "vulnerabilities": [
    {
      "VulnId": "CVE-2024-10046",
      "VulnTitle": "Security Vulnerability 46",
      "Severity": "Low",
      "CVSS": 6.6,
      "MachineName": "SRV-APP-019",
      "AssetCriticality": "Low",
      "DiscoveryDate": "2025-09-19T21:29:57Z",
      "LastModified": "2025-10-11T21:29:57Z",
      "Status": "Open",
      "PatchAvailable": true,
      "ExploitAvailable": true
    },
    {
      "VulnId": "CVE-2024-10047",
      "VulnTitle": "Security Vulnerability 47",
      "Severity": "Low",
      "CVSS": 4.1,
      "MachineName": "SRV-DB-050",
      "AssetCriticality": "High",
      "DiscoveryDate": "2025-12-27T21:29:50Z",
      "LastModified": "2026-01-03T21:29:50Z",
      "Status": "In Progress",
      "PatchAvailable": true,
      "ExploitAvailable": false
    },
    {
      "VulnId": "CVE-2024-10048",
      "VulnTitle": "Security Vulnerability 48",
      "Severity": "Low",
      "CVSS": 8.5,
      "MachineName": "SRV-DC-035",
      "AssetCriticality": "High",
      "DiscoveryDate": "2025-12-25T21:28:57Z",
      "LastModified": "2026-01-03T21:28:57Z",
      "Status": "In Progress",
      "PatchAvailable": true,
      "ExploitAvailable": false
    },
    {
      "VulnId": "CVE-2024-10049",
      "VulnTitle": "Security Vulnerability 49",
      "Severity": "Low",
      "CVSS": 8.0,
      "MachineName": "SRV-WEB-011",
      "AssetCriticality": "Medium",
      "DiscoveryDate": "2025-12-13T21:29:19Z",
      "LastModified": "2026-01-03T21:29:19Z",
      "Status": "In Progress",
      "PatchAvailable": true,
      "ExploitAvailable": false
    }
  ]
}</div>

                    <div class="field-callout">
                        <strong>Sentinel Integration:</strong> These fields align with Microsoft Sentinel data connector schemas. Map <code>Severity</code> and <code>CVSS</code> for alert severity scoring, use <code>LastModified</code> for incremental polling, and leverage <code>ExploitAvailable</code> and <code>PatchAvailable</code> for risk prioritization in your security workflows.
                    </div>
                </div>
            </section>

            <!-- Pagination Section -->
            <section id="pagination">
                <h2>Pagination</h2>
                <p>The API uses cursor-based pagination to handle large result sets efficiently. This approach is ideal for incremental data ingestion and scheduled polling patterns.</p>

                <h3>How Pagination Works</h3>
                <ol style="margin-left: 20px; margin-top: 15px;">
                    <li>Make an initial request without a <code>next_token</code> parameter</li>
                    <li>If <code>next_token</code> is present in the response, more results are available</li>
                    <li>Include the <code>next_token</code> in your next request to retrieve the following page</li>
                    <li>Repeat until <code>next_token</code> is null (indicates last page)</li>
                </ol>

                <h3>Pagination Parameters</h3>
                <ul>
                    <li><strong>page_size:</strong> Controls how many results are returned per request (default: 50, max: 1000)</li>
                    <li><strong>next_token / nextToken:</strong> Cursor for fetching the next page (both camelCase and snake_case supported)</li>
                </ul>

                <h3>Complete Pagination Flow</h3>
                <div class="code-block">Request 1:
GET /api/vulnerabilities?page_size=50

Response 1:
{
  "vulnerabilities": [...],      // 50 items
  "next_token": "NTA=",           // Base64 encoded offset
  "total_filtered": 250,
  "page_size": 50,
  "offset": 0
}

Request 2:
GET /api/vulnerabilities?page_size=50&next_token=NTA=

Response 2:
{
  "vulnerabilities": [...],      // 50 items
  "next_token": "MTAw",           // Next offset
  "total_filtered": 250,
  "page_size": 50,
  "offset": 50
}</div>

                <div class="field-callout">
                    <strong>Performance Tip:</strong> For large datasets, use pagination with time-based filtering to retrieve only recent changes. This pattern is efficient for scheduled polling and incremental data synchronization scenarios.
                </div>
            </section>

            <!-- Filtering Section -->
            <section id="filtering">
                <h2>Filtering</h2>
                <p>Filter vulnerabilities by time range using ISO 8601 datetime parameters. This enables efficient incremental data retrieval and change detection.</p>

                <h3>Time Range Filtering</h3>
                <p>Use the following parameters to filter by modification date:</p>
                <ul>
                    <li><strong>createdAt__gt:</strong> Greater than (return results modified after this timestamp)</li>
                    <li><strong>createdAt__lt:</strong> Less than (return results modified before this timestamp)</li>
                </ul>

                <h3>ISO 8601 Datetime Format</h3>
                <p>Datetime values must be in ISO 8601 format with timezone information:</p>
                <div class="code-block">2024-01-15T10:30:00Z
2024-01-15T10:30:00+00:00
2024-01-15T10:30:00-05:00</div>

                <h3>Filtering Examples</h3>
                <p>Get vulnerabilities modified in the last 7 days:</p>
                <div class="code-block">GET /api/vulnerabilities?createdAt__gt=2024-01-01T00:00:00Z&createdAt__lt=2024-01-08T00:00:00Z</div>

                <p>Combine filtering with pagination for efficient incremental sync:</p>
                <div class="code-block">GET /api/vulnerabilities?page_size=100&createdAt__gt=2024-01-01T00:00:00Z</div>

                <div class="field-callout">
                    <strong>Data Connector Pattern:</strong> Store the <code>LastModified</code> timestamp from your last successful poll. Use it in the next request with <code>createdAt__gt</code> parameter to retrieve only new and updated vulnerabilities since your last sync.
                </div>
            </section>

            <!-- Examples Section -->
            <section id="examples">
                <h2>Examples</h2>

                <h3>Example 1: Basic Request</h3>
                <p>Retrieve the first 50 vulnerabilities:</p>
                <div class="code-block">curl -H "Authorization: cvebuster-demo-key-12345" \
  http://cvebuster.eastus.cloudapp.azure.com:5000/api/vulnerabilities</div>

                <h3>Example 2: Custom Page Size</h3>
                <p>Retrieve 100 vulnerabilities per page:</p>
                <div class="code-block">curl -H "Authorization: cvebuster-demo-key-12345" \
  "http://cvebuster.eastus.cloudapp.azure.com:5000/api/vulnerabilities?page_size=100"</div>

                <h3>Example 3: Pagination with Token</h3>
                <p>Fetch the next page using a pagination token:</p>
                <div class="code-block">curl -H "Authorization: cvebuster-demo-key-12345" \
  "http://cvebuster.eastus.cloudapp.azure.com:5000/api/vulnerabilities?next_token=NTA="</div>

                <h3>Example 4: Time Range Filtering</h3>
                <p>Get vulnerabilities modified in a specific date range:</p>
                <div class="code-block">curl -H "Authorization: cvebuster-demo-key-12345" \
  "http://cvebuster.eastus.cloudapp.azure.com:5000/api/vulnerabilities?createdAt__gt=2024-01-01T00:00:00Z&createdAt__lt=2024-01-08T00:00:00Z"</div>

                <h3>Example 5: Complete Python Integration</h3>
                <div class="code-block">import requests
import json
from datetime import datetime, timedelta

API_KEY = "cvebuster-demo-key-12345"
BASE_URL = "http://cvebuster.eastus.cloudapp.azure.com:5000/api"

headers = {"Authorization": API_KEY}

# Get vulnerabilities from last 24 hours
now = datetime.utcnow()
yesterday = now - timedelta(days=1)

params = {
    "page_size": 100,
    "createdAt__gt": yesterday.isoformat() + "Z"
}

all_vulnerabilities = []
next_token = None

while True:
    if next_token:
        params["next_token"] = next_token
    
    response = requests.get(
        f"{BASE_URL}/vulnerabilities",
        headers=headers,
        params=params
    )
    
    data = response.json()
    all_vulnerabilities.extend(data["vulnerabilities"])
    
    print(f"Fetched {len(data['vulnerabilities'])} vulnerabilities")
    print(f"Total so far: {len(all_vulnerabilities)}")
    
    if not data.get("next_token"):
        break
    
    next_token = data["next_token"]

print(f"Total vulnerabilities retrieved: {len(all_vulnerabilities)}")</div>
            </section>

            <!-- Error Handling Section -->
            <section id="errors">
                <h2>Error Handling</h2>

                <h3>HTTP Status Codes</h3>
                <table class="parameter-table">
                    <thead>
                        <tr>
                            <th>Status Code</th>
                            <th>Description</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span class="status-code status-200">200</span></td>
                            <td>OK - Request successful</td>
                            <td>Process the returned data</td>
                        </tr>
                        <tr>
                            <td><span class="status-code status-401">401</span></td>
                            <td>Unauthorized - Invalid API key</td>
                            <td>Verify your API key is correct</td>
                        </tr>
                        <tr>
                            <td><span class="status-code status-500">500</span></td>
                            <td>Internal Server Error</td>
                            <td>Check server status and retry</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Error Response Format</h3>
                <div class="code-block">{
  "error": "Unauthorized"
}</div>

                <h3>Common Issues and Solutions</h3>
                <ul>
                    <li><strong>401 Unauthorized:</strong> Double-check your API key in the Authorization header</li>
                    <li><strong>Invalid next_token:</strong> Tokens may expire or become invalid; make a new request without a token</li>
                    <li><strong>Malformed datetime:</strong> Ensure datetime values are in ISO 8601 format with timezone info</li>
                    <li><strong>500 Server Error:</strong> The data file may be missing; contact system administrator</li>
                </ul>

                <div class="alert alert-warning">
                    <strong>Debugging Tip:</strong> Check the server logs to understand why a request failed. The API logs all incoming requests with their parameters.
                </div>
            </section>
        </div>
    </div>

    <script>
        function scrollToSection(event, sectionId) {
            event.preventDefault();
            
            // Update active nav link
            document.querySelectorAll('.nav-tabs a').forEach(link => {
                link.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Scroll to section
            const section = document.getElementById(sectionId);
            if (section) {
                section.scrollIntoView({ behavior: 'smooth' });
            }
        }

        // Update active tab on scroll
        window.addEventListener('scroll', () => {
            const sections = document.querySelectorAll('section');
            let currentSection = '';
            
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                if (window.pageYOffset >= sectionTop - 200) {
                    currentSection = section.getAttribute('id');
                }
            });
            
            document.querySelectorAll('.nav-tabs a').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === `#${currentSection}`) {
                    link.classList.add('active');
                }
            });
        });
    </script>
</body>
</html>
